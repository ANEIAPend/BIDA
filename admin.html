<!DOCTYPE html>
<html lang="es">
<head>
	<title>Inicio</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<link rel="stylesheet" href="css/main.css">
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
	<!-- SideBar -->
	<section class="full-box cover dashboard-sideBar">
		<div class="full-box dashboard-sideBar-bg btn-menu-dashboard"></div>
		<div class="full-box dashboard-sideBar-ct">
			<!--SideBar Title -->
			<div class="full-box text-uppercase text-center text-titles dashboard-sideBar-title">
				BIDA ðŸ’šðŸ’™ <i class="zmdi zmdi-close btn-menu-dashboard visible-xs"></i>
			</div>
			<!-- SideBar User info -->
			<div class="full-box dashboard-sideBar-UserInfo">
				<figure class="full-box">
					<img src="./assets/img/avatar.jpg" alt="UserIcon">
					<figcaption class="text-center text-titles">Nombre de Usuario</figcaption>
				</figure>
				<ul class="full-box list-unstyled text-center">
					<li>
						<a href="#!">
							<i class="zmdi zmdi-settings"></i>
						</a>
					</li>
					<li>
						<a href="#!" class="btn-exit-system">
							<i class="zmdi zmdi-power"></i>
						</a>
					</li>
				</ul>
			</div>
			<!-- SideBar Menu -->
			<ul class="list-unstyled full-box dashboard-sideBar-Menu">
				<li>
					<a href="home.html">
						<i class="zmdi zmdi-view-dashboard zmdi-hc-fw"></i> Dashboard
					</a>
				</li>
				<li>
					<a href="#!" class="btn-sideBar-SubMenu">
						<i class="zmdi zmdi-case zmdi-hc-fw"></i> AdministraciÃ³n <i class="zmdi zmdi-caret-down pull-right"></i>
					</a>
					<ul class="list-unstyled full-box">
						<li>
							<a href="period.html"><i class="zmdi zmdi-timer zmdi-hc-fw"></i> Perido</a>
						</li>
						<li>
							<a href="subject.html"><i class="zmdi zmdi-book zmdi-hc-fw"></i> Sujeto</a>
						</li>
						<li>
							<a href="section.html"><i class="zmdi zmdi-graduation-cap zmdi-hc-fw"></i> Seccional</a>
						</li>
						<li>
							<a href="salon.html"><i class="zmdi zmdi-font zmdi-hc-fw"></i> Salon</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="#!" class="btn-sideBar-SubMenu">
						<i class="zmdi zmdi-account-add zmdi-hc-fw"></i> Usuarios <i class="zmdi zmdi-caret-down pull-right"></i>
					</a>
					<ul class="list-unstyled full-box">
						<li>
							<a href="admin.html"><i class="zmdi zmdi-account zmdi-hc-fw"></i> Admins</a>
						</li>
						<li>
							<a href="teacher.html"><i class="zmdi zmdi-male-alt zmdi-hc-fw"></i> Presidentes</a>
						</li>
						<li>
							<a href="student.html"><i class="zmdi zmdi-face zmdi-hc-fw"></i> Asociados</a>
						</li>
						<li>
							<a href="representative.html"><i class="zmdi zmdi-male-female zmdi-hc-fw"></i> JDN-IN</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="#!" class="btn-sideBar-SubMenu">
						<i class="zmdi zmdi-card zmdi-hc-fw"></i> MembresÃ­as <i class="zmdi zmdi-caret-down pull-right"></i>
					</a>
					<ul class="list-unstyled full-box">
						<li>
							<a href="registration.html"><i class="zmdi zmdi-money-box zmdi-hc-fw"></i> Registro</a>
						</li>
						<li>
							<a href="payments.html"><i class="zmdi zmdi-money zmdi-hc-fw"></i> Pagos</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="#!" class="btn-sideBar-SubMenu">
						<i class="zmdi zmdi-shield-security zmdi-hc-fw"></i> Tutoriales <i class="zmdi zmdi-caret-down pull-right"></i>
					</a>
					<ul class="list-unstyled full-box">
						<li>
							<a href="school.html"><i class="zmdi zmdi-balance zmdi-hc-fw"></i> Datos del capÃ­tulo</a>
						</li>
					</ul>
				</li>
			</ul>
		</div>
		<div class="full-box sidebar-footer text-center">
			<p>&copy;  ANEIAP 2024.</p>
			<p><a href="#!" class="terms-link">TÃ©rminos y condiciones</a></p>
		</div>
	</section>
	<!-- Content page-->
	<section class="full-box dashboard-contentPage">

		<div class="container-fluid">
			<div class="page-header">
			  <h1 class="text-titles"><i class="zmdi zmdi-account zmdi-hc-fw"></i> Usuarios/Asociados <small>Admin</small></h1>
			</div>
			<p class="lead">AquÃ­ va la informacion de los administradores de B.I.D.A</p>
		</div>
		<div class="container-fluid">
			<div class="row">
				<div class="col-xs-12">
					<ul class="nav nav-tabs" style="margin-bottom: 15px;">
					  	<li class="active"><a href="#new" data-toggle="tab">Nuevo</a></li>
					  	<li><a href="#list" data-toggle="tab">Lista</a></li>
					</ul>
					<div>
						
					</div>
					<div id="myTabContent" class="tab-content">
					  	<div class="tab-pane fade" id="list">
							<div class="table-responsive">
								<table class="table table-hover text-center">
									<thead>
										<tr>
											<th class="text-center">#</th>
											<th class="text-center">Nombre</th>
											<th class="text-center">Apellido</th>
											<th class="text-center">CapÃ­tulo</th>
											<th class="text-center">Direccion</th>
											<th class="text-center">Correo ANEIAP</th>
											<th class="text-center">NÃºmero de telefono</th>
											<th class="text-center">Update</th>
											<th class="text-center">Delete</th>
										</tr>
									</thead>
									<tbody>
										
									</tbody id="tbody1">
								</table>
								<ul class="pagination pagination-sm">
								  	<li class="disabled"><a href="#!">Â«</a></li>
								  	<li class="active"><a href="#!">1</a></li>
								  	<li><a href="#!">2</a></li>
								  	<li><a href="#!">3</a></li>
								  	<li><a href="#!">4</a></li>
								  	<li><a href="#!">5</a></li>
								  	<li><a href="#!">Â»</a></li>
								</ul>
							</div>
					  	</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!--====== Scripts -->
	<script src="./js/jquery-3.1.1.min.js"></script>
	<script src="./js/sweetalert2.min.js"></script>
	<script src="./js/bootstrap.min.js"></script>
	<script src="./js/material.min.js"></script>
	<script src="./js/ripples.min.js"></script>
	<script src="./js/jquery.mCustomScrollbar.concat.min.js"></script>
	<script src="./js/main.js"></script>
	<script>
		$.material.init();
	</script>
	<script type="module">
		// Import the functions you need from the SDKs you need
		import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
		import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-analytics.js";
		// TODO: Add SDKs for Firebase products that you want to use
		// https://firebase.google.com/docs/web/setup#available-libraries
		import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js";
	
		// ConfiguraciÃ³n de Firebase
		// Your web app's Firebase configuration
		// For Firebase JS SDK v7.20.0 and later, measurementId is optional
		const firebaseConfig = {
			apiKey: "AIzaSyDgLEBbn_PU7nrWsMFe5xtgOwiG3M77unk",
			authDomain: "bida-bc35f.firebaseapp.com",
			databaseURL: "https://bida-bc35f-default-rtdb.firebaseio.com",
			projectId: "bida-bc35f",
			storageBucket: "bida-bc35f.appspot.com",
			messagingSenderId: "51120819237",
			appId: "1:51120819237:web:2bb84a589ac3e1352403cc",
			measurementId: "G-Q16S4BJHYP"
		};
	
		// Inicializar Firebase
		const app = initializeApp(firebaseConfig);
		const analytics = getAnalytics(app);
		const db = getDatabase();
	
		// Asegurarse de que el DOM estÃ© completamente cargado
		document.addEventListener('DOMContentLoaded', () => {
			console.log('DOM completamente cargado');

			let Nombres = document.getElementById('Nombres');
			let Apellidos = document.getElementById('Apellidos');
			let id_capitulo = document.getElementById('Nombre_CapÃ­tulo');
			let Area = document.getElementById('Area');
			let correo_corporativo = document.getElementById('Correo_Corporativo');
			let celular = document.getElementById('Telefono Celular');
			let NUIA = document.getElementById('NUIA');
			let estado = document.getElementById('estado');
			let fecha_nacimiento = document.getElementById('fecha_nacimiento');
			let membresia = document.getElementById('membresia');
			let semestre_actual = document.getElementById('semestre_actual');
			let semestre_ingreso = document.getElementById('semestre_ingreso');
			let tipo_membresia = document.getElementById('tipo_membresia');

			let save_button = document.getElementById('save_button');
	
			// Verificar si los elementos estÃ¡n bien capturados
			if (!save_button || !Nombres || !Apellidos || !id_capitulo || !Area || !correo_corporativo || !Telefono || !NUIA) {
				console.error("Uno o mÃ¡s elementos del formulario no fueron encontrados. Verifica los IDs.");
				return;
			}
	
			// FunciÃ³n para agregar datos
			function AddData(){
				console.log('BotÃ³n presionado');
				console.log('Datos capturados: ', {
					nombres: Nombres.value,
					apellidos: Apellidos.value,
					id_capitulo: id_capitulo.value,
					area: Area.value,
					correo_corporativo: correo_corporativo.value,
					celular: celular.value,
					nuia:NUIA.value,
					estado:estado.value,
					fecha_nacimiento: fecha_nacimiento.value,
					membresia: membresia.value,
					semestre_actual: semestre_actual.value,
					semestre_ingreso: semestre_ingreso.value,
					tipo_membresia: tipo_membresia.value,
				});
	
				set(ref(db, 'Asociado/' + NUIA.value), {
					nombres: Nombres.value, 
					apellidos: Apellidos.value,
					id_capitulo: id_capitulo.value,
					area: Area.value,
					correoCorporativo: correo_corporativo.value,
					telefono: Number(Telefono.value),
					nuia: Number(NUIA.value),
					estado:estado.value,
					fecha_nacimiento: fecha_nacimiento.value,
					membresia: membresia.value,
					semestre_actual: Number(semestre_actual.value),
					semestre_ingreso: Number(semestre_ingreso.value),
					tipo_membresia: tipo_membresia.value,

				}).then(() => {
					alert("Datos agregados correctamente");
				}).catch((error)=> {
					alert("No se subieron los datos");
					console.error("Error al subir los datos: ", error);
				});
			}
	
			// AÃ±adir el listener al botÃ³n de guardar
			save_button.addEventListener('click', AddData);
		});

		let lista_asociados = [];
		let sn0 = 0;

		SelectAllDataOnce = () => {
			const dbRef = ref(db);  // Crea una referencia a la base de datos de Firebase
			get(child(dbRef, 'Asociado/'))  // ObtÃ©n los datos del nodo 'ListofEmployees'
				.then((snapshot) => {  // Cuando los datos son recuperados exitosamente
					lista_asociados = [];  // Inicializa una lista vacÃ­a para almacenar los asociados
					snapshot.forEach(asociado => {  // Itera sobre cada asociado en los datos
						lista_asociados.push(asociado.val());  // Agrega el valor del asociado a la lista
					});
					AddAllRecords();  // Llama a la funciÃ³n para procesar los registros
				});
		};

		const AddSingleRecord = (nuia, nombres, apellidos, area, correoCorporativo, telefono) => {
            // Crear una nueva fila
            let trow = document.createElement('tr');

            // Crear las celdas de la tabla
            let td1 = document.createElement('td');
            let td2 = document.createElement('td');
            let td3 = document.createElement('td');
            let td4 = document.createElement('td');
            let td5 = document.createElement('td');
			let td6 = document.createElement('td');
			let td7 = document.createElement('td');

            // Asignar el contenido a cada celda
            td1.innerHTML = ++sno;  // Incrementar el nÃºmero de serie
            td2.innerHTML = NUIA;
            td3.innerHTML = Nombres;
            td4.innerHTML = Apellidos;
            td5.innerHTML = Area;
			td6.innerHTML = Correo_Corporativo;
			td7.innerHTML = Telefono;

            // AÃ±adir las celdas a la fila
            trow.append(td1, td2, td3, td4, td5, td6, td7);
			tbody.append(trow);

            // AÃ±adir la fila al cuerpo de la tabla
            document.getElementById('recordBody').append(trow);
        };

		const AddAllRecords = () => {
			sno = 0;
			tbody.innerHTML = "";
			lista_asociados.forEach(asociado => {
				AddSingleRecord(asociado.nuia, asociado.Nombres, asociado.Apellidos, asociado.Area, asociado.Correo_Corporativo, asociado.Telefono);
			})
		}

	</script>
	
</body>
</html>
